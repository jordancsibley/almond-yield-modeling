---
title: "Almond Yield Profit Model"
subtitle: "EDS 230 - Assignment #3"
date: "04/21/2025"
format: html
author: "Jordan Sibley and Marina Kochuten" 
editor_options: 
  chunk_output_type: console
---

## Overview




3.  Perform a simple informal sensitivity analysis of almond yield profit using at least 2 parameters

4.  Create 2 graphs

-   one that shows yield anomaly for each year, accounting for uncertainty in the parameters
-   one that show how yield anomaly in general varies with your parameters

5.  Write a short paragraph to summarize you interpretation of your model results (e.g what do 'take away' from your model and sensitivity analysis)

## Setup

```{r}
# Load libraries
library(tidyverse)
library(here)
library(purrr)
```

## Data Prep

```{r}
# Read in climate data
data <- read.table("data/clim.txt", header = TRUE, sep = " ", stringsAsFactors = FALSE)

# Filter not complete years - no Jan or Feb data for 1988
data_clean <- data |> 
  filter(year != 1988)
```

## Running the Model

```{r}
# Source function
source(here("R", "almond-yield-profit.R"))

# Calculate annual almond profits
almond_profits <- calculate_yield_and_profit(data_clean)
```

## Informal Sensitivity Analysis

```{r}
# Set seed
set.seed(222)

# Simulate uncertainty in both almond price and production cost
sensitivity_values <- tibble(
  almond_price <- rnorm(mean = 2000, sd = 200, n = 20),
  cost_per_acre <- rnorm(mean = 1000, sd = 50, n = 20))


# Run uncertaintly through model
uncertainty_results <- pmap(sensitivity_values ~ calculate_yield_and_profit(climate_df_clean = data_clean,
                                                          almond_price = almond_price,
                                                          cost_per_acre = cost_per_acre))
```








